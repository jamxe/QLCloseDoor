# Remote Android
一款用于远程自动化测试 Android 应用的工具

![RemoteAndroid](https://github.com/kasuganosoras/RemoteAndroid/assets/34357771/a4b41d74-dfe1-4f23-8bba-bd9689d6d2dd)

## 功能介绍

- 支持自定义按钮位置
- 支持操作 3 个按钮（后续会考虑继续更新）
- 支持通过 API 远程调用，配合 HTTP Shortcuts 食用更佳
- 可配置延迟时间
- 支持使用物理手机挂机，按键后自动息屏保护屏幕
- 启动程序后自动运行外部程序（例如 Frp）

## 使用方法

> 软件需要安装 [.Net 桌面运行时 8.0](https://dotnet.microsoft.com/zh-cn/download/dotnet/thank-you/runtime-desktop-8.0.6-windows-x64-installer) 才能使用，请先安装运行时。

软件需要配合模拟器来进行操作，有显卡的电脑推荐夜神模拟器，没显卡的可以用网易 mumu 模拟器。

1. 下载安装任意支持 ADB 的模拟器，建议选择 Android 12 版本
2. 在模拟器内正常安装要测试的软件
3. 根据模拟器官方说明寻找 ADB 端口（夜神默认 `62001`，网易 mumu 默认 `16384`）
4. 在软件内的 ADB 地址处输入 `127.0.0.1`，端口输入对应的 ADB 端口。
5. 软件右侧日志出现 `Connect: 模拟器型号` 则表示已经连接成功

## 按钮坐标配置
夜神模拟器配置：
* 按钮1 X：`541`
* 按钮1 Y：`641`
* 按钮2 X：`205`
* 按钮2 Y：`938`
* 按钮3 X：`541`
* 按钮3 Y：`938`

网易 mumu 模拟器配置：
* 按钮1 X：`541`
* 按钮1 Y：`938`
* 按钮2 X：`230`
* 按钮2 Y：`1319`
* 按钮3 X：`541`
* 按钮3 Y：`1319`

其他模拟器可以通过在开发者选项里启用 __指针位置__ 选项，然后滑动屏幕来查看当前 X Y 坐标（屏幕顶上会显示）。

## 配合 HTTP Shortcuts 使用
你可以下载并安装 [HTTP Shortcuts](https://http-shortcuts.rmy.ch/) 或其他类似软件来实现在主屏幕上点击按钮一键执行。

要实现外网远程控制，你需要使用有公网 IP 的电脑来挂机或者配合内网穿透使用，此部分已超出本项目的范畴，请自行上网搜寻相关教程。

在 HTTP Shortcuts 内创建一个新的快捷方式，基本设置里面按照以下进行设置：

```text
请求方法：GET
请求地址：http://你的外网IP:外网端口号/click?token=你的秘钥&btn=按钮编号
```

* **外网 IP：** 如果你的电脑有公网 IP，并且你做了端口转发，此处可以填写你的外网 IP 或者 DDNS 映射的域名；如果你使用的是内网穿透，请在这里填写你穿透后的域名或 IP 地址。
* **外网端口号：** 软件默认监听的端口号是 `14190`，如果你做了端口转发或内网穿透，请在这里填写外网端口。
* **你的秘钥：** 在这里填写你的秘钥（秘钥在 config.ini 里面可以配置），默认是 `123456789`。
* **按钮编号：** 要点击的按钮，目前支持 `1`、`2`、`3` 三个按钮。

示例：
```
GET http://123.45.67.89:14190/click?token=123456789&btn=1
```

保存快捷方式，然后将它放置到桌面上，你就可以使用桌面快捷方式来一键执行了。

> ### ⚠️ 请注意
> 每次点击按钮之后请等待 30 秒左右再次点击，因为每次执行之后软件会自动重启来关闭某些广告。

## App 重启延迟
每台电脑的性能不一样，App 的响应速度也不一样，如果出现按下按钮之后，App 还没执行完成就被自动重启的情况，可以修改 config.ini 并修改 `closeWait` 选项的数值，该数值决定了按钮点击后等待多久重启 App，单位为毫秒，默认为 `2500`，可以适当增加到 `3500` 或更高的值。

## 执行后自动将设备息屏
如果使用物理设备进行测试，则可以配置执行成功后自动息屏，防止 OLED 烧屏的问题。

启用方法：修改 config.ini，将 `autoLockScreen` 的参数设置为 `True`。

## 启动后自动运行程序
您可以设置 Remote Android 在启动后自动运行的外部程序。修改 config.ini，设置 `afterLaunch` 选项为您想要运行的程序的 **可执行文件路径**，`afterLaunchArgs` 选项为程序的执行参数（可空），保存后重启 Remote Android 即可。

## 其他 API

* 网页在线控制：`/?token=你的秘钥`
* 获取当前连接信息：`/info?token=你的秘钥`
* 点击屏幕指定坐标：`/click?token=你的秘钥&x=横向坐标&y=纵向坐标`
* 获取模拟器屏幕截图：`/screenshot?token=你的秘钥`
* 重启测试软件：`/restart?token=你的秘钥`
* 模拟按下电源键：`/powerbtn?token=你的秘钥`
* 模拟滑动屏幕解锁：`/unlock?token=你的秘钥`（不支持输入密码，只能设置无密码）

调用方法参考上面按钮配置。

## 编译说明
编译完成后你需要将 adb 目录复制到编译后的二进制文件同目录下，软件会在启用时自动调用 adb\adb.exe 来连接模拟器。
